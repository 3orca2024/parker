<!-- Princess Flap Game -->
<div id="flap" class="game-section" style="display:none;">
  <canvas id="flapCanvas" width="400" height="500" style="background:linear-gradient(#d9c9ff,#fff0f6); border:2px solid purple; display:block; margin:auto;"></canvas>
  <p style="text-align:center; color:purple; font-weight:bold;">Press SPACE to fly! Avoid the wands!</p>
</div>

<script>
const flapCanvas = document.getElementById("flapCanvas");
const ctx = flapCanvas.getContext("2d");

let princess, gravity, lift, velocity, wands, score, gameOver;

function startFlap() {
  princess = { x: 80, y: 200, radius: 20 };
  gravity = 0.6;
  lift = -10;
  velocity = 0;
  wands = [];
  score = 0;
  gameOver = false;
  document.addEventListener("keydown", flapKey);
  setInterval(addWand, 2000);
  requestAnimationFrame(drawFlap);
}

function flapKey(e) {
  if (e.code === "Space" && !gameOver) {
    velocity += lift;
  }
}

function addWand() {
  if (gameOver) return;
  let gap = 120;
  let topHeight = Math.floor(Math.random() * 250) + 50;
  wands.push({
    x: flapCanvas.width,
    top: topHeight,
    bottom: topHeight + gap,
    width: 40
  });
}

function drawFlap() {
  ctx.clearRect(0, 0, flapCanvas.width, flapCanvas.height);

  // Princess character
  ctx.fillStyle = "pink";
  ctx.beginPath();
  ctx.arc(princess.x, princess.y, princess.radius, 0, Math.PI*2);
  ctx.fill();
  ctx.strokeStyle = "purple";
  ctx.stroke();

  // Physics
  velocity += gravity;
  princess.y += velocity;
  if (princess.y + princess.radius > flapCanvas.height) {
    princess.y = flapCanvas.height - princess.radius;
    gameOver = true;
  }
  if (princess.y - princess.radius < 0) {
    princess.y = princess.radius;
  }

  // Wands (obstacles)
  ctx.fillStyle = "purple";
  for (let i = 0; i < wands.length; i++) {
    let w = wands[i];
    // Top wand
    ctx.fillRect(w.x, 0, w.width, w.top);
    // Bottom wand
    ctx.fillRect(w.x, w.bottom, w.width, flapCanvas.height - w.bottom);

    w.x -= 2;

    // Collision
    if (
      princess.x + princess.radius > w.x &&
      princess.x - princess.radius < w.x + w.width &&
      (princess.y - princess.radius < w.top || princess.y + princess.radius > w.bottom)
    ) {
      gameOver = true;
    }

    // Scoring
    if (w.x + w.width === princess.x) {
      score++;
    }
  }

  // Draw score
  ctx.fillStyle = "darkmagenta";
  ctx.font = "20px Arial";
  ctx.fillText("Score: " + score, 10, 25);

  if (!gameOver) {
    requestAnimationFrame(drawFlap);
  } else {
    ctx.fillStyle = "red";
    ctx.font = "30px Arial";
    ctx.fillText("Game Over!", 120, 250);
  }
}

// Hook this into your "Start" button for Flap
function startFlapGame() {
  startFlap();
}
</script>

